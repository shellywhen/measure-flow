{"version":3,"sources":["brainView.ts"],"names":[],"mappings":"AASA,IAAI,aAAa,GAAG,CAAC,CAAC;AACtB,IAAI,UAAU,GAAG,QAAQ,CAAC;AAC1B,IAAI,UAAU,GAAG,QAAQ,CAAC;AAC1B,IAAI,eAAe,GAAG,QAAQ,CAAC;AAE/B,IAAI,oBAAoB,GAAG,EAAE,CAAC;AAE9B,IAAI,iBAAiB,GAAG,EAAE,CAAC;AAE3B,IAAI,QAAQ,GAAW,GAAG,CAAC;AAG3B,IAAI,aAAa,GACb;IACI,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACtD,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACpD,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACtD,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACrD,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACnD,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACrD,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACpD,EAAE,IAAI,EAAE,aAAa,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;IACzD,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACnD,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IAClD,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACnD,EAAE,IAAI,EAAE,aAAa,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACzD,EAAE,IAAI,EAAE,YAAY,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACvD,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACxD,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACtD,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACtD,EAAE,IAAI,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACtD,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACvD,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACrD,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACrD,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACjD,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACrD,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;CACtD,CAAC;AAEN;IAGI,iBAAY,CAAS;QACjB,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;QACd,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;IACjB,CAAC;IACL,cAAC;AAAD,CAPA,AAOC,IAAA;AAED,IAAI,KAAK,GAAW,MAAM,CAAC,UAAU,CAAC;AACtC,IAAI,MAAM,GAAW,MAAM,CAAC,WAAW,CAAC;AAExC,IAAI,OAAO,GAAW,WAAW,CAAC,UAAU,EAAE,CAAC;AAI/C,IAAI,MAAM,GAA6B,WAAW,CAAC,eAAe,EAAE,CAAC;AACrE,IAAI,SAAS,GAAqB,MAAM,CAAC,SAAS,CAAC;AACnD,IAAI,OAAO,GAAqB,MAAM,CAAC,OAAO,CAAC;AAG/C,WAAW,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC;AACjD,WAAW,CAAC,gBAAgB,CAAC,WAAW,EAAE,gBAAgB,CAAC,CAAC;AAI5D,IAAI,UAAU,CAAC;AACf,IAAI,KAAK,GAAG,MAAM,CAAC,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC;AACrC,IAAI,KAAK,GAAG,MAAM,CAAC,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC;AAErC,IAAI,aAAa,GAAG,MAAM,CAAC,KAAK,EAAE,CAAC;AAGnC,IAAI,aAAa,GAAG,QAAQ,CAAC;AAC7B,IAAI,UAAU,GAAG,QAAQ,CAAC;AAG1B,IAAI,iBAAyB,CAAC;AAC9B,IAAI,YAAoB,CAAC;AAEzB,IAAI,IAA8B,CAAC;AACnC,IAAI,UAAU,GAAG,CAAC,CAAC;AAGnB,IAAI,OAAO,GAAG,EAAE,CAAC,MAAM,CAAC,UAAU,CAAC;KAC9B,MAAM,CAAC,KAAK,CAAC;KACb,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC;KACpB,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;AAExB,IAAI,iBAAiB,GAAG,KAAK,GAAG,GAAG,CAAC;AACpC,IAAI,eAAe,GAAG,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC;KACxC,MAAM,CAAC,KAAK,CAAC;KACb,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC;KACvB,IAAI,CAAC,OAAO,EAAE,iBAAiB,CAAC;KAChC,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;AAExB,IAAI,MAAM,CAAC;AACX,IAAI,WAAW,GAAW,KAAK,CAAC;AAChC,IAAI,YAAY,GAAW,MAAM,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,YAAY,CAAC,CAAC,MAAM,EAAE,CAAC;AAqBtF,IAAI,SAAc,CAAC;AACnB,IAAI,MAAW,CAAC;AAChB,IAAI,KAAU,CAAC;AACf,IAAI,QAAa,CAAC;AAClB,IAAI,QAAa,CAAC;AAClB,IAAI,MAAW,CAAC;AAGhB,IAAI,OAAY,CAAC;AACjB,IAAI,aAAkB,CAAC;AAEvB,IAAI,OAAO,GAAG,EAAE,CAAC;AACjB,IAAI,UAAsB,CAAC;AAC3B,IAAI,sBAAmC,CAAC;AAExC,IAAI,UAAiC,CAAC;AAEtC,WAAW,EAAE,CAAC;AAEd;IACI,IAAI,EAAE,CAAC;IACP,OAAO,EAAE,CAAC;AACd,CAAC;AAED;IAEI,IAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAC9C,CAAC,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IAEhC,MAAM,GAAG,IAAI,KAAK,CAAC,iBAAiB,CAAC,EAAE,EACnC,WAAW,GAAG,YAAY,EAAE,CAAC,EAAE,IAAI,CAAC,CAAA;IACxC,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG,CAAC;IAExB,QAAQ,GAAG,IAAU,KAAM,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;IAEtD,QAAQ,CAAC,WAAW,GAAG,GAAG,CAAC;IAC3B,QAAQ,CAAC,SAAS,GAAG,GAAG,CAAC;IACzB,QAAQ,CAAC,QAAQ,GAAG,GAAG,CAAC;IAExB,QAAQ,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;IAEvB,QAAQ,CAAC,YAAY,GAAG,IAAI,CAAC;IAC7B,QAAQ,CAAC,oBAAoB,GAAG,GAAG,CAAC;IAEpC,QAAQ,CAAC,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;IAC7B,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC;IAIzB,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;IAE1B,IAAI,OAAO,GAAG,IAAI,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;IAC/C,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;IAEnB,IAAI,gBAAgB,GAAG,IAAI,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;IAC5D,gBAAgB,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACvC,KAAK,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IAK5B,IAAI,OAAO,GAAG,IAAI,KAAK,CAAC,cAAc,EAAE,CAAC;IACzC,OAAO,CAAC,UAAU,GAAG,UAAU,IAAI,EAAE,MAAM,EAAE,KAAK;IAElD,CAAC,CAAC;IAGF,IAAI,MAAM,GAAG,IAAU,KAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;IAEjD,MAAM,CAAC,IAAI,CAAC,gCAAgC,EAAE,gBAAgB,CAAC,CAAC;IAGhE,gBAAgB,EAAE,CAAC;IAEnB,QAAQ,GAAG,IAAI,KAAK,CAAC,aAAa,EAAE,CAAC;IACrC,QAAQ,CAAC,OAAO,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;IAC5C,QAAQ,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;IACpC,MAAM,GAAG,QAAQ,CAAC,UAAU,CAAC;IAC7B,CAAC,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IAC5B,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC,UAAU,SAAS;QACrD,MAAM,CAAC,UAAU,CAAC;YACd,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,CAAA;QAC1B,CAAC,CAAA;IACL,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;IACV,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;IAC9C,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;IAChD,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;IAIxC,UAAU,GAAG,IAAI,UAAU,CAAC,MAAM,EAAE,KAAK,GAAG,EAAE,CAAC,CAAC;IAChD,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;IAE7B,sBAAsB,GAAG,IAAI,WAAW,CAAC,EAAE,EAAE,EAAE,EAAE,iBAAiB,GAAG,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IAC5F,sBAAsB,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;IACjD,sBAAsB,CAAC,kBAAkB,CAAC,UAAC,GAAG,EAAE,GAAG;QAC/C,WAAW,CAAC,IAAI,CAAC,CAAC;IACtB,CAAC,CAAC,CAAC;IACH,CAAC,CAAC,eAAe,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC;QAChC,sBAAsB,CAAC,aAAa,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;QACzE,WAAW,CAAC,IAAI,CAAC,CAAC;IACtB,CAAC,CAAC,CAAC;AACP,CAAC;AAED;IAGI,aAAa,GAAG,EAAE,CAAC;IACnB,IAAI,WAAW,GAAG,EAAE,CAAC;IAErB,IAAI,YAAY,GAAG,IAAI,KAAK,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;IAC/C,IAAI,IAAsB,CAAC;IAE3B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QACpC,WAAW,CAAC,CAAC,CAAC,GAAG,YAAY,CAAC;QAC9B,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QAChB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAC5C,EAAE,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBACnD,IAAI,CAAC,CAAC,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC5B,IAAI,CAAC,CAAC,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC5B,IAAI,CAAC,CAAC,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC5B,IAAI,CAAC,MAAM,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;gBACtC,KAAK,CAAC;YACV,CAAC;QACL,CAAC;QACD,IAAI,WAAW,GAAG,IAAI,KAAK,CAAC,iBAAiB,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,OAAO,EAAE,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;QAC/F,IAAI,MAAM,GAAG,aAAa,CAAC;QAC3B,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;YACZ,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QACzB,IAAI,MAAM,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC;QACxF,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;QAG5C,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC1C,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;QACpB,IAAI,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;QACtB,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IACtB,CAAC;IAGD,OAAO,GAAG,EAAE,CAAC;IACb,IAAI,IAAI,CAAC;IACT,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QACpC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QAChB,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAA;QACnB,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC;QACpB,IAAI,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,CAAA;QAEvD,EAAE,CAAC,CAAC,CAAC,SAAS,IAAI,SAAS,GAAG,CAAC,CAAC;YAC5B,QAAQ,CAAC;QAEb,IAAI,QAAQ,GAAG,IAAI,KAAK,CAAC,QAAQ,EAAE,CAAC;QACpC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACzD,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEzD,IAAI,mBAAmB,GAAG,IAAI,KAAK,CAAC,iBAAiB,CAAC;YAClD,KAAK,EAAE,UAAU;YACjB,WAAW,EAAE,IAAI;YACjB,OAAO,EAAE,oBAAoB;YAC7B,SAAS,EAAE,SAAS,GAAG,iBAAiB;SAC3C,CAAC,CAAA;QAEF,IAAI,IAAI,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,mBAAmB,CAAC,CAAC;QAEzD,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACnB,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACpB,CAAC;AAEL,CAAC;AAED,mCAAmC,CAAS;IACxC,EAAE,CAAC,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAC,CAAC;QACpC,EAAE,CAAC,CAAC,CAAC,GAAG,sBAAsB,CAAC,GAAG,IAAI,CAAC,GAAG,sBAAsB,CAAC,GAAG,CAAC;YACjE,MAAM,CAAC,IAAI,CAAC;QAChB,IAAI;YACA,MAAM,CAAC,KAAK,CAAC;IAErB,CAAC;IAAC,IAAI,CAAC,CAAC;QACJ,EAAE,CAAC,CAAC,CAAC,GAAG,sBAAsB,CAAC,GAAG,IAAI,CAAC,GAAG,sBAAsB,CAAC,GAAG,CAAC;YACjE,MAAM,CAAC,IAAI,CAAC;QAChB,IAAI;YACA,MAAM,CAAC,KAAK,CAAC;IACrB,CAAC;AACL,CAAC;AAED;IACI,IAAI,SAAiB,CAAC;IACtB,IAAI,IAAsB,CAAC;IAC3B,IAAI,KAAK,CAAC;IACV,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QACtC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QAEhB,IAAI,aAAa,GAAY,IAAI,CAAC;QAClC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YACpB,aAAa,GAAG,KAAK,CAAC;QAC1B,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,yBAAyB,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;YAC5E,aAAa,GAAG,KAAK,CAAC;QAC1B,CAAC;QAED,EAAE,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC;YAEjB,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC;gBAClC,UAAU,CAAC,GAAG,CAAC,IAAI,UAAU,CAAC,gBAAgB,CAC1C,OAAO,CAAC,CAAC,CAAC,EACV,CAAC,EACD,QAAQ,CACX,CAAC,CAAC;YACP,CAAC;YACD,QAAQ,CAAC;QACb,CAAC;QAED,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;YACnC,UAAU,CAAC,GAAG,CAAC,IAAI,UAAU,CAAC,gBAAgB,CAC1C,OAAO,CAAC,CAAC,CAAC,EACV,oBAAoB,EACpB,QAAQ,CACX,CAAC,CAAC;QACP,CAAC;QAMD,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,SAAS,GAAG,SAAS,GAAG,iBAAiB,CAAC;QAC9D,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;YACvB,KAAK,GAAG,eAAe,CAAC;QAC5B,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YAC3B,KAAK,GAAG,WAAW,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;YAC3C,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC;gBACP,KAAK,GAAG,UAAU,CAAC;QAC3B,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,KAAK,GAAG,UAAU,CAAC;QACvB,CAAC;QAED,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IACvD,CAAC;AACL,CAAC;AAED;IAEI,IAAI,IAAsB,CAAC;IAC3B,IAAI,KAAK,CAAC;IACV,IAAI,GAAG,CAAC;IACR,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QACpC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QAChB,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;QAInB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YACpB,GAAG,CAAC,QAAQ,CAAC,OAAO,GAAG,CAAC,CAAC;YACzB,GAAG,CAAC,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC;YAChC,QAAQ,CAAC;QACb,CAAC;QAGD,EAAE,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;YAC5B,GAAG,CAAC,QAAQ,CAAC,OAAO,GAAG,CAAC,CAAC;YACzB,GAAG,CAAC,QAAQ,CAAC,WAAW,GAAG,KAAK,CAAC;QACrC,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;YACvB,KAAK,GAAG,eAAe,CAAA;QAC3B,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YAC3B,KAAK,GAAG,WAAW,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;YAC3C,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACT,KAAK,GAAG,UAAU,CAAC;YACvB,CAAC;QACL,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,KAAK,GAAG,UAAU,CAAC;QACvB,CAAC;QACD,GAAG,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IAChD,CAAC;AACL,CAAC;AAED,0BAA0B,MAAM;IAE5B,MAAM,CAAC,QAAQ,CAAC,UAAU,KAAK;QAC3B,EAAE,CAAC,CAAC,KAAK,YAAY,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;YAC9B,KAAK,CAAC,QAAQ;kBACR,IAAI,KAAK,CAAC,mBAAmB,CAAC;oBAC5B,KAAK,EAAE,QAAQ;oBACf,WAAW,EAAE,IAAI;oBACjB,OAAO,EAAE,GAAG;oBACZ,IAAI,EAAE,KAAK,CAAC,UAAU;iBACzB,CAAC,CAAC;QACX,CAAC;IAEL,CAAC,CAAC,CAAC;IAEH,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC7B,UAAU,GAAG,MAAM,CAAC;IACpB,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACtB,CAAC;AAED;IACI,qBAAqB,CAAC,OAAO,CAAC,CAAC;IAC/B,QAAQ,CAAC,MAAM,EAAE,CAAC;IAClB,MAAM,EAAE,CAAC;AACb,CAAC;AAED;IAEI,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;AACnC,CAAC;AAED,mBAAmB,KAAK;IAGpB,MAAM,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;IAC7B,IAAI,SAAS,GAAG,IAAI,KAAK,CAAC,SAAS,EAAE,CAAC;IACtC,IAAI,GAAG,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;IAE9B,MAAM,CAAC,GAAG,CACN,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC,GAAG,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,EAC5C,CAAE,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,MAAM,GAAG,YAAY,CAAC,GAAG,EAAE,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC,EACzE,GAAG,CAAC,CAAC;IAET,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;IAEzB,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,EACzB,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,SAAS,EAAE,CAAC,CAAC;IAE7C,IAAI,YAAY,CAAC;IAEjB,IAAI,WAAW,GAAG,SAAS,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;IACtD,IAAI,KAAK,CAAA;IACT,EAAE,CAAC,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;QACzB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAC1C,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAA;YAC9C,YAAY,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;QAClC,CAAC;IACL,CAAC;IAGD,IAAI,YAAY,CAAC;IACjB,WAAW,GAAG,SAAS,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;IAClD,EAAE,CAAC,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;QACzB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAC1C,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAA;YAC9C,YAAY,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;YAC9B,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;gBAChC,CAAC,CAAC,gBAAgB,CAAC,CAAC,MAAM,EAAE,CAAA;gBAG5B,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBAC1C,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,eAAe,CAAC,CAAA;gBACzC,KAAK,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;gBAClC,KAAK,CAAC,SAAS,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC;gBACvC,KAAK,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC,GAAG,IAAI,CAAC;gBAC9C,KAAK,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC,GAAG,IAAI,CAAC;gBAC/C,KAAK,CAAC,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC;gBAC9B,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YACrC,CAAC;QACL,CAAC;IACL,CAAC;IAAC,IAAI,CAAC,CAAC;QACJ,CAAC,CAAC,gBAAgB,CAAC,CAAC,MAAM,EAAE,CAAA;IAChC,CAAC;IACD,WAAW,CAAC,SAAS,CAAC,KAAK,EAA+B,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC,CAAC;IACnF,WAAW,CAAC,SAAS,CAAC,KAAK,EAA+B,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC,CAAC;IAEnF,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;AACnC,CAAC;AAED;IAGI,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QACpC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;YAM3B,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;gBAGzB,WAAW,CAAC,SAAS,CAAC,KAAK,EAA+B,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;YACrF,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,IAAI,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE,CAAC;gBAC1C,IAAI,gBAAgB,GAAG,MAAM,CAAC,mBAAmB,EAAE,CAAC;gBACpD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;oBACzC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,gBAAgB,CAAC,CAAC,CAAC;wBACpC,WAAW,CAAC,SAAS,CAAC,QAAQ,EAA+B,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;wBACpF,MAAM,CAAC;oBACX,CAAC;gBACL,CAAC;gBAGD,WAAW,CAAC,SAAS,CAAC,KAAK,EAA+B,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;YACrF,CAAC;QACL,CAAC;IACL,CAAC;IAGD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QACpC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;YAM3B,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;gBAGzB,WAAW,CAAC,SAAS,CAAC,KAAK,EAA+B,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;YACrF,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,IAAI,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE,CAAC;gBAC1C,IAAI,gBAAgB,GAAG,MAAM,CAAC,mBAAmB,EAAE,CAAC;gBACpD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;oBACzC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,gBAAgB,CAAC,CAAC,CAAC;wBACpC,WAAW,CAAC,SAAS,CAAC,QAAQ,EAA+B,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;wBACpF,MAAM,CAAC;oBACX,CAAC;gBACL,CAAC;gBAGD,WAAW,CAAC,SAAS,CAAC,KAAK,EAA+B,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;YACrF,CAAC;QACL,CAAC;IACL,CAAC;AACL,CAAC;AAGD;IACI,QAAQ,CAAC,KAAK,EAAE,CAAC;IACjB,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IAChC,MAAM,EAAE,CAAC;AACb,CAAC;AACD;IACI,QAAQ,CAAC,KAAK,EAAE,CAAC;IACjB,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAChC,MAAM,EAAE,CAAC;AACb,CAAC;AACD;IACI,QAAQ,CAAC,KAAK,EAAE,CAAC;IACjB,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;IAC7C,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;IAC/B,MAAM,EAAE,CAAC;AACb,CAAC;AAED;IACI,OAAO,CAAC,GAAG,CAAC,sBAAsB,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;IACvE,EAAE,CAAA,CAAE,CAAC,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACjC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;IAC1B,IAAI;QACA,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;IAC7B,MAAM,EAAE,CAAC;AACb,CAAC;AAGD,0BAA0B,CAA+B;IACrD,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;IACnC,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IAC/B,WAAW,EAAE,CAAC;IACd,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;AACvC,CAAC;AAGD;IACI,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAA;IACvB,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC;AAC7B,CAAC;AAED;IACI,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAA;IACxB,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC;AAC5B,CAAC;AAOD,qBAAqB,CAAsB;IAEvC,UAAU,GAAG,IAAI,UAAU,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;IAE/C,WAAW,EAAE,CAAC;IACd,WAAW,EAAE,CAAC;IAEd,UAAU,CAAC,KAAK,EAAE,CAAC;IAEnB,MAAM,EAAE,CAAC;AACb,CAAC","file":"brainView.js","sourcesContent":["///-----------------------------------------------------------------------------------------------------------------\n/// brainView.ts.  Copyright (c) 2014 Microsoft Corporation.\n///     - manages a 3D view of the brain, with support for brushing and linking.\n///-----------------------------------------------------------------------------------------------------------------\n/// <reference path=\"../../core/networkcube.d.ts\"/>\n/// <reference path=\"../widgets/widgets.d.ts\" />\n/// <reference path=\"../utils/animations.d.ts\" />\n\n\nvar SPHERE_RADIUS = 2;\nvar COLOR_LINK = 0x333333;\nvar COLOR_NODE = 0x666666;\nvar COLOR_HIGHLIGHT = 0xff0000;\n\nvar OPACITY_LINE_DEFAULT = .5;\n\nvar LINK_WIDTH_FACTOR = 10;\n\nvar DURATION: number = 500;\n\n\nvar ROI_POSITIONS =\n    [\n        { name: \"DANLaIPS\", x: -45, y: -37, z: 48, radius: 2 },\n        { name: \"DANLFEF\", x: -29, y: -5, z: 55, radius: 2 },\n        { name: \"DANLpIPS\", x: -26, y: -65, z: 52, radius: 2 },\n        { name: \"DANRaIPS\", x: 43, y: -36, z: 46, radius: 2 },\n        { name: \"DANRFEF\", x: 31, y: -5, z: 54, radius: 2 },\n        { name: \"DANRpIPS\", x: 28, y: -65, z: 51, radius: 2 },\n        { name: \"DMNLAG\", x: -48, y: -66, z: 34, radius: 2 },\n        { name: \"DMNLlattemp\", x: -65, y: -23, z: -9, radius: 2 },\n        { name: \"DMNmPFC\", x: -1, y: 61, z: 22, radius: 2 },\n        { name: \"DMNPCC\", x: 1, y: -51, z: 29, radius: 2 },\n        { name: \"DMNRAG\", x: 53, y: -61, z: 35, radius: 2 },\n        { name: \"DMNRlattemp\", x: 61, y: -21, z: -12, radius: 2 },\n        { name: \"FPTCLdlPFC\", x: -44, y: 27, z: 33, radius: 2 },\n        { name: \"FPTCLfrontal\", x: -42, y: 7, z: 36, radius: 2 },\n        { name: \"FPTCLIPL\", x: -53, y: -50, z: 39, radius: 2 },\n        { name: \"FPTCLIPS\", x: -32, y: -58, z: 46, radius: 2 },\n        { name: \"FPTCRdlPFC\", x: 46, y: 28, z: 31, radius: 2 },\n        { name: \"FPTCRfrontal\", x: 44, y: 8, z: 34, radius: 2 },\n        { name: \"FPTCRIPL\", x: 54, y: -44, z: 43, radius: 2 },\n        { name: \"FPTCRIPS\", x: 32, y: -59, z: 41, radius: 2 },\n        { name: \"SALACC\", x: 7, y: 33, z: 19, radius: 2 },\n        { name: \"SALLFIC\", x: -32, y: 25, z: -10, radius: 2 },\n        { name: \"SALRFIC\", x: 34, y: 26, z: -6, radius: 2 }\n    ];\n\nclass NBounds {\n    left: number;\n    top: number;\n    constructor(v: number) {\n        this.left = v;\n        this.top = v;\n    }\n}\n\nvar width: number = window.innerWidth;\nvar height: number = window.innerHeight;\n\nvar urlVars: Object = networkcube.getUrlVars();\n\n\n// GET DATA\nvar _graph: networkcube.DynamicGraph = networkcube.getDynamicGraph();\nvar startTime: networkcube.Time = _graph.startTime;\nvar endTime: networkcube.Time = _graph.endTime;\n\n// EVENT HANDLERS\nnetworkcube.setDefaultEventListener(updateEvent);\nnetworkcube.addEventListener('timeRange', timeRangeHandler);\n\n\n// data\nvar brainModel;\nvar nodes = _graph.nodes().toArray();\nvar links = _graph.links().toArray();\n//var _windowCount = endTime.id - startTime.id;\nvar _correlations = _graph.links();\n\n// colors\nvar _defaultColor = 0x293d66;\nvar _overColor = 0xe31a1c;\n\n// current state\nvar _subjectSelection: number;\nvar _currentTime: number;\n\nvar _ctx: CanvasRenderingContext2D;\nvar _drawTimer = 0;\n\n// create timeslider\nvar timeSvg = d3.select('#menubar')\n    .append('svg')\n    .attr('width', width)\n    .attr('height', 50);\n\nvar linkWtFilterWidth = width - 150;\nvar linkWtFilterSvg = d3.select('#footerbar')\n    .append('svg')\n    .style('float', 'right')\n    .attr('width', linkWtFilterWidth)\n    .attr('height', 50);\n\nvar vector; // mous vector\nvar canvasWidth: number = width;\nvar canvasHeight: number = height - $('#menubar').height() - $('#footerbar').height();\n\n// layoutView();\n\n// function layoutView() {\n//     //---- size CANVAS ----\n//     jQuery(\"#nodelinkArea\")\n//         .attr(\"width\", canvasWidth)\n//         .attr(\"height\", canvasHeight)\n\n//     //\n//     // //---- size OUTER height ----\n//     // jQuery(\"#outer\")\n//     //     .css(\"height\", canvasHeight)\n// }\n\n//// 3D brain\n\n// hard coded data\n\n// 3D elements\nvar container: any;\nvar camera: any;\nvar scene: any;\nvar renderer: any;\nvar controls: any;\nvar canvas: any;\n\n// indexes to retrieve 3D objects\nvar links3D: any;\nvar node3DIndices: any;\n\nvar nodes3D = [];\nvar timeSlider: TimeSlider;\nvar linkWeightFilterSlider: RangeSlider;\n\nvar transition: animations.Transition;\n\nload3DBrain();\n\nfunction load3DBrain() {\n    init();\n    animate();\n}\n\nfunction init() {\n\n    var container = document.createElement('div');\n    $('#maindiv').append(container);\n\n    camera = new THREE.PerspectiveCamera(45,\n        canvasWidth / canvasHeight, 1, 2000)\n    camera.position.z = 300;\n\n    controls = new (<any>THREE).TrackballControls(camera);\n\n    controls.rotateSpeed = 1.0;\n    controls.zoomSpeed = 1.2;\n    controls.panSpeed = 0.8;\n\n    controls.noZoom = false;\n    controls.noPan = false;\n\n    controls.staticMoving = true;\n    controls.dynamicDampingFactor = 0.3;\n\n    controls.keys = [65, 83, 68];\n    controls.enabled = false;\n\n    // scene\n\n    scene = new THREE.Scene();\n\n    var ambient = new THREE.AmbientLight(0x1f1f1f);\n    scene.add(ambient);\n\n    var directionalLight = new THREE.DirectionalLight(0x1f1f1f);\n    directionalLight.position.set(0, 0, 1);\n    scene.add(directionalLight);\n\n\n    // texture\n\n    var manager = new THREE.LoadingManager();\n    manager.onProgress = function (item, loaded, total) {\n        //console.log(item, loaded, total);\n    };\n\n    // brainsurface model\n    var loader = new (<any>THREE).OBJLoader(manager);\n    //loader.load('BrainMesh_ch2.obj', loadBrainSurface);\n    loader.load('BrainMesh_ICBM152_smoothed.obj', loadBrainSurface);\n\n    //ROIs\n    createNodeLink3D();\n\n    renderer = new THREE.WebGLRenderer();\n    renderer.setSize(canvasWidth, canvasHeight);\n    renderer.setClearColor(0xFFFFFF, 1);\n    canvas = renderer.domElement;\n    $('#menubar').after(canvas);\n    canvas.addEventListener('mousemove', (function (thisclass) {\n        return function (e) {\n            thisclass.mousemove(e)\n        }\n    })(this));\n    canvas.addEventListener('mouseout', mouseOut);\n    canvas.addEventListener('mouseover', mouseOver);\n    canvas.addEventListener('click', click);\n\n\n    // attach timeslider\n    timeSlider = new TimeSlider(_graph, width - 50);\n    timeSlider.appendTo(timeSvg);\n\n    linkWeightFilterSlider = new RangeSlider(50, 25, linkWtFilterWidth - 100, -1, 1, 0.5, true);\n    linkWeightFilterSlider.appendTo(linkWtFilterSvg);\n    linkWeightFilterSlider.setDragEndCallBack((min, max) => {\n        updateEvent(null);\n    });\n    $('#invertFilter').click(function (e) {\n        linkWeightFilterSlider.setIsInverted($('#invertFilter').prop('checked'));\n        updateEvent(null);\n    });\n}\n\nfunction createNodeLink3D() {\n\n    // create spheres for each ROIs and position in MNI space\n    node3DIndices = [];\n    var nodesColors = [];\n    //#293d66;\n    var defaultColor = new THREE.Color(COLOR_NODE);\n    var node: networkcube.Node;\n    // assign positions\n    for (var i = 0; i < nodes.length; i++) {\n        nodesColors[i] = defaultColor;\n        node = nodes[i];\n        for (var j = 0; j < ROI_POSITIONS.length; j++) {\n            if (ROI_POSITIONS[j].name.indexOf(node.label()) > -1) {\n                node.x = ROI_POSITIONS[j].x;\n                node.y = ROI_POSITIONS[j].y;\n                node.z = ROI_POSITIONS[j].z;\n                node.radius = ROI_POSITIONS[j].radius;\n                break;\n            }\n        }\n        var ROIMaterial = new THREE.MeshBasicMaterial({ color: COLOR_NODE, shading: THREE.NoShading });\n        var radius = SPHERE_RADIUS;\n        if (node.radius)\n            radius = node.radius;\n        var node3D = new THREE.Mesh(new THREE.SphereGeometry(node.radius, 20, 20), ROIMaterial);\n        node3D.position.set(node.x, node.y, node.z);\n\n        // keep index to update node color/visibility later\n        node3DIndices.push(scene.children.length);\n        nodes3D.push(node3D)\n        node['mesh'] = node3D;\n        scene.add(node3D);\n    }\n\n    // create correlations objects\n    links3D = [];\n    var link;\n    for (var i = 0; i < links.length; i++) {\n        link = links[i];\n        var u = link.source\n        var v = link.target;\n        var corrValue = link.weights(startTime, endTime).mean()\n\n        if (!corrValue || corrValue < 0)\n            continue;\n\n        var geometry = new THREE.Geometry();\n        geometry.vertices.push(new THREE.Vector3(u.x, u.y, u.z));\n        geometry.vertices.push(new THREE.Vector3(v.x, v.y, v.z));\n\n        var correlationMaterial = new THREE.LineBasicMaterial({\n            color: COLOR_LINK,\n            transparent: true,\n            opacity: OPACITY_LINE_DEFAULT,\n            linewidth: corrValue * LINK_WIDTH_FACTOR\n        })\n\n        var line = new THREE.Line(geometry, correlationMaterial);\n        //keep index to update the links later\n        links3D.push(line);\n        scene.add(line);\n    }\n\n}\n\nfunction isOutsideLinkWeightFilter(v: number): boolean {\n    if (linkWeightFilterSlider.isInverted) {\n        if (v > linkWeightFilterSlider.min && v < linkWeightFilterSlider.max)\n            return true;\n        else\n            return false;\n\n    } else {\n        if (v < linkWeightFilterSlider.min || v > linkWeightFilterSlider.max)\n            return true;\n        else\n            return false;\n    }\n}\n\nfunction updateLinks() {\n    var corrValue: number;\n    var link: networkcube.Link;\n    var color;\n    for (var i = 0; i < links3D.length; i++) {\n        link = links[i];\n        // we use the values mean to determine whether to display the link\n        var linkIsVisible: boolean = true;\n        if (!link.isVisible()) {\n            linkIsVisible = false;\n        } else if (isOutsideLinkWeightFilter(link.weights(startTime, endTime).mean())) {\n            linkIsVisible = false;\n        }\n\n        if (!linkIsVisible) {\n            // remove from display\n            if (links3D[i].material.opacity > 0) {\n                transition.add(new animations.OpacityAnimation(\n                    links3D[i],\n                    0,\n                    DURATION\n                ));\n            }\n            continue;\n        }\n        // test whether not present already\n        if (links3D[i].material.opacity == 0) {\n            transition.add(new animations.OpacityAnimation(\n                links3D[i],\n                OPACITY_LINE_DEFAULT,\n                DURATION\n            ));\n        }\n\n        // corrValue = link.weights(startTime, endTime).mean()\n        // if (!corrValue || corrValue < 0)\n        //     continue;\n\n        links3D[i].material.linewidth = corrValue * LINK_WIDTH_FACTOR;\n        if (link.isHighlighted()) {\n            color = COLOR_HIGHLIGHT;\n        } else if (link.isSelected()) {\n            color = networkcube.getPriorityColor(link);\n            if (!color)\n                color = COLOR_LINK;\n        } else {\n            color = COLOR_LINK;\n        }\n\n        links3D[i].material.color = new THREE.Color(color);\n    }\n}\n\nfunction updateNodes() {\n\n    var node: networkcube.Node;\n    var color;\n    var n3d;\n    for (var i = 0; i < nodes.length; i++) {\n        node = nodes[i];\n        n3d = node['mesh'];\n\n\n        // CHECK AND UPDATE VISIBILITY\n        if (!node.isVisible()) {\n            n3d.material.opacity = 0;\n            n3d.material.transparent = true;\n            continue;\n        }\n\n        // test whether not present already\n        if (n3d.material.opacity == 0) {\n            n3d.material.opacity = 1;\n            n3d.material.transparent = false;\n        }\n\n        if (node.isHighlighted()) {\n            color = COLOR_HIGHLIGHT\n        } else if (node.isSelected()) {\n            color = networkcube.getPriorityColor(node);\n            if (!color) {\n                color = COLOR_NODE;\n            }\n        } else {\n            color = COLOR_NODE;\n        }\n        n3d.material.color = new THREE.Color(color);\n    }\n}\n\nfunction loadBrainSurface(object) {\n\n    object.traverse(function (child) {\n        if (child instanceof THREE.Mesh) {\n            child.material\n                = new THREE.MeshLambertMaterial({\n                    color: 0xbbbbbb,\n                    transparent: true,\n                    opacity: 0.1,\n                    side: THREE.DoubleSide\n                });\n        }\n\n    });\n\n    object.position.set(0, 0, 0);\n    brainModel = object;\n    scene.add(object);\n}\n\nfunction animate(): void {\n    requestAnimationFrame(animate);\n    controls.update();\n    render();\n}\n\nfunction render() {\n\n    renderer.render(scene, camera);\n}\n\nfunction mousemove(event) {\n\n    // Ray cast to detect if user hovers ROI\n    vector = new THREE.Vector3();\n    var raycaster = new THREE.Raycaster();\n    var dir = new THREE.Vector3();\n\n    vector.set(\n        ((event.clientX - 10) / canvasWidth) * 2 - 1,\n        - ((event.clientY - (height - canvasHeight) - 11) / canvasHeight) * 2 + 1,\n        0.5); // z = 0.5 important!\n\n    vector.unproject(camera);\n\n    raycaster.set(camera.position,\n        vector.sub(camera.position).normalize());\n\n    var hoveredLinks;\n    // Look for intersected links\n    var intersected = raycaster.intersectObjects(links3D);\n    var index\n    if (intersected.length > 0) {\n        for (var i = 0; i < intersected.length; i++) {\n            index = links3D.indexOf(intersected[i].object)\n            hoveredLinks = [links[index]];\n        }\n    }\n\n    // Look for intersected nodes\n    var hoveredNodes;\n    intersected = raycaster.intersectObjects(nodes3D);\n    if (intersected.length > 0) {\n        for (var i = 0; i < intersected.length; i++) {\n            index = nodes3D.indexOf(intersected[i].object)\n            hoveredNodes = [nodes[index]];\n            if (!nodes[index].isHighlighted()) {\n                $('#brainROIlabel').remove()\n\n                //draw ROI label text\n                var text2 = document.createElement('div');\n                text2.setAttribute('id', 'brainROIlabel')\n                text2.style.position = 'absolute';\n                text2.innerHTML = nodes[index].label();\n                text2.style.top = (event.clientY - 10) + 'px';\n                text2.style.left = (event.clientX + 20) + 'px';\n                text2.style.fontSize = \"20px\";\n                document.body.appendChild(text2);\n            }\n        }\n    } else {\n        $('#brainROIlabel').remove()\n    }\n    networkcube.highlight('set', <networkcube.ElementCompound>{ links: hoveredLinks });\n    networkcube.highlight('set', <networkcube.ElementCompound>{ nodes: hoveredNodes });\n\n    renderer.render(scene, camera);\n}\n\nfunction click() {\n\n    // test for which nodes must be added to selection\n    for (var i = 0; i < nodes.length; i++) {\n        if (nodes[i].isHighlighted()) {\n            // if(nodes[i].isSelected()){\n            //     networkcube.selection('remove', {nodeIds: [nodes[i].map((n,i)=>n.id)]});\n            // }else{\n            //     networkcube.selection('add', {nodes: [nodes[i].map((n,i)=>n.id)]});\n            // }\n            if (!nodes[i].isSelected()) {\n                // if this element has not been selected yet,\n                // add it to current selection.\n                networkcube.selection('add', <networkcube.ElementCompound>{ nodes: [nodes[i]] });\n            } else {\n                var selections = nodes[i].getSelections();\n                var currentSelection = _graph.getCurrentSelection();\n                for (var j = 0; j < selections.length; j++) {\n                    if (selections[j] == currentSelection) {\n                        networkcube.selection('remove', <networkcube.ElementCompound>{ nodes: [nodes[i]] });\n                        return;\n                    }\n                }\n                // current selection has not been found among already\n                // assigned selections, hence add this selection\n                networkcube.selection('add', <networkcube.ElementCompound>{ nodes: [nodes[i]] });\n            }\n        }\n    }\n\n    // test for which links must be added to selection\n    for (var i = 0; i < links.length; i++) {\n        if (links[i].isHighlighted()) {\n            // if(links[i].isSelected()){\n            //     networkcube.selection('remove', {links: [links[i]]});\n            // }else{\n            //     networkcube.selection('add', {links: [links[i]]});\n            // }\n            if (!links[i].isSelected()) {\n                // if this element has not been selected yet,\n                // add it to current selection.\n                networkcube.selection('add', <networkcube.ElementCompound>{ links: [links[i]] });\n            } else {\n                var selections = links[i].getSelections();\n                var currentSelection = _graph.getCurrentSelection();\n                for (var j = 0; j < selections.length; j++) {\n                    if (selections[j] == currentSelection) {\n                        networkcube.selection('remove', <networkcube.ElementCompound>{ links: [links[i]] });\n                        return;\n                    }\n                }\n                // current selection has not been found among already\n                // assigned selections, hence add this selection\n                networkcube.selection('add', <networkcube.ElementCompound>{ links: [links[i]] });\n            }\n        }\n    }\n}\n\n\nfunction setFrontLook() {\n    controls.reset();\n    camera.position.set(0, -300, 0);\n    render();\n}\nfunction setSideLook() {\n    controls.reset();\n    camera.position.set(-300, 0, 0);\n    render();\n}\nfunction setTopLook() {\n    controls.reset();\n    camera.rotation.set(90 * Math.PI / 180, 0, 0)\n    camera.position.set(0, 0, 300);\n    render();\n}\n\nfunction showBrain(){\n    console.log(\"brainview::showBrain\" + $('#brainModel').prop(\"checked\"));\n    if( $('#brainModel').prop(\"checked\"))\n        scene.add(brainModel);\n    else\n        scene.remove(brainModel);\n    render();\n}\n\n\nfunction timeRangeHandler(m: networkcube.TimeRangeMessage) {\n    startTime = _graph.time(m.startId);\n    endTime = _graph.time(m.endId);\n    updateLinks();\n    timeSlider.set(startTime, endTime);\n}\n\n// Disables trackball controls, otherwise bugs\nfunction mouseOut() {\n    console.log('mouseOut')\n    controls.enabled = false;\n}\n// Enables trackball controls again after mouse out\nfunction mouseOver() {\n    console.log('mouseOver')\n    controls.enabled = true;\n}\n\n\n\n\n// NETWORKCUBE EVENTS\n\nfunction updateEvent(m: networkcube.Message) {\n\n    transition = new animations.Transition(render);\n\n    updateLinks();\n    updateNodes();\n\n    transition.start();\n\n    render();\n}\n"],"sourceRoot":"/source/"}